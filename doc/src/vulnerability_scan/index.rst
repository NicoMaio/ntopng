Vulnerability Scan
##################


With this feature, it is possible to execute a vulnerability scan on a specific host or on multiple hosts simultaneously.

After the execution of the vulnerability scan, if a host presents new CVEs not detected before, a 'Vulnerability Scan Changes' alert will be triggered.

Vulnerability Scan Page
~~~~~~~~~~~~~~~~~~~~~~~

.. figure:: ../img/va_page.png
  :align: center
  :alt: Vulnerability Scan Page

  Vulnerability Scan Page

On the Vulnerability Scan page, it is possible to view the registered hosts that can be scanned, along with various details about the last executed scan, such as:

- Scan Type;
- Num. CVEs (vulnerabilities detected);
- Open Ports (number of open ports found);
- Last Scan Duration;
- Last Scan Date;
- Periodicity (for automatic scans, available only with an Enterprise L license);
- Last Scan Status (can be "Success", "In Progress", "Not Scanned", "Error");

At the bottom of the page, there are three buttons:

- Delete All (to remove all hosts from the vulnerability scan list);
- Schedule All Scans (to schedule a scan for all hosts in the vulnerability scan list);
- Update All Periodicity Scan (to update the periodicity scan for all hosts in the vulnerability scan list);

Row Actions
~~~~~~~~~~~

.. figure:: ../img/va_actions_menu.png
  :align: center
  :alt: Row Actions menu

  Row Actions menu 

Clicking on the 'Actions' dropdown of a specific row provides the following options:

- Edit Host (to modify the specifications of the selected row);
- Schedule Scan (to schedule the vulnerability scan of the specific host);
- Download Last Scan Report (to download the file containing the most recent vulnerability scan report); 
- Show Last Scan Report (to display the last scan report in a new page of ntopng);
- Delete (to delete the specific host from the vulnerability scan list); 

Vulnerability Scan Report Page
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. figure:: ../img/va_result_page.png
  :align: center
  :alt: Vulnerability Scan Report Page

  Vulnerability Scan Report Page

Clicking on the `Show Last Scan Report` button in the Actions dropdown menu of a specific row allows ntopng to display the last scan report of the selected host.

Add Host to Vulnerabily Scan List
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. figure:: ../img/va_modal.png
  :align: center
  :alt: Add Host to Vulnerability Scan List

  Add Host to Vulnerability Scan List

By clicking on the '+' icon on the Vulnerability Scan page, the user can add a new host or include all hosts active under a specific CIDR.

If a user designates a specific active host, ntopng will automatically populate the Ports field; otherwise, it will remain empty. 
When the Ports field is empty and the user clicks the 'Add' button, the next scan will encompass all ports of the host.

After selecting the host and ports, it is mandatory to choose one of the Vulnerability Scan Types. 
Currently, only two types of vulnerability scans are supported:

- CVE;
- OpenVAS;

If ntopng is operating with an Enterprise L license, the user will have the option to choose a specific Scan Frequency for automatic execution of Vulnerability Scans. 
The available Scan Frequencies are:

- Every Day;
- Every Week;
